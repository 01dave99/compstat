install.packages("HDInterval")
knitr::opts_chunk$set(echo = TRUE)
library(HDInterval)
mydata$V7<-<-as.numeric(mydata$V7)
mydata$V7<-as.numeric(mydata$V7)
knitr::opts_chunk$set(echo = TRUE)
library(HDInterval)
knitr::opts_chunk$set(echo = TRUE)
library(HDInterval)
```{r}
mydata<-read.table("Report2_Dataset.txt", header=FALSE)
mydata<-read.table("Report2_Dataset.txt", header=FALSE)
```{r}
\subsection{Ascicles}
\subsubsection{1.1 Model selection}
\subsection{1. Sex}
n<-length(mydata$V6[!is.na(mydata$V7)])
s<-sum(mydata$V7)
n
s
\subsection{1. Sex}
\subsubsection{1.2 Results}
\subsubsection{1.1 Model selection}
\subsection{1. Sex}
\subsection{1. Sex}
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
n<-length(mydata$V6[!is.na(mydata$V7)])
s<-sum(mydata$V7)
n
s
mean<-(2+s)/(4+n)
mode<-(1+s)/(2+n)
cil<-qbeta(0.05/2,278,38)
ciu<-qbeta(1-0.05/2,278,38)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
```{r}
```{r}
cil<-qbeta(0.05/2,1+s,1 + n-s)
ciu<-qbeta(1-0.05/2,1+s,1 + n-s)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
}
```{r}
mean<-(2+s)/(4+n)
mode<-(1+s)/(2+n)
cil<-qbeta(0.05/2,1+s,1 + n-s)
ciu<-qbeta(1-0.05/2,1+s,1 + n-s)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
}
cil<-qbeta(0.05/2,1+s,1 + n-s)
ciu<-qbeta(1-0.05/2,1+s,1 + n-s)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
}
beta_posterior(1, 1)
n<-length(mydata$V6[!is.na(mydata$V7)])
s<-sum(mydata$V7)
mean<-(2+s)/(4+n)
mode<-(1+s)/(2+n)
cil<-qbeta(0.05/2, 1+s, 1 + n - s)
ciu<-qbeta(1-0.05/2,1+s, 1 + n - s)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
s/n
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
```{r, echo=FALSE}
hdi(rbeta(1e5, 1+s, 1 + n - s))
knitr::opts_chunk$set(echo = TRUE)
library(HDInterval)
mydata$V11<-as.numeric(mydata$V11)
hist(mydata$V11)
bilirubin<-as.numeric(mydata$V11)
hist(bilirubin)
n<-length(mydata$V6[!is.na(mydata$V6)])
s<-sum(mydata$V6)
n
s
albumin<-as.numeric(mydata$V13)
hist(albumin)
istall.packages("R2OpenBUGS",dependencies=TRUE,repos="http://cran.us.r-project.org")
install.packages("R2OpenBUGS",dependencies=TRUE,repos="http://cran.us.r-project.org")
file.show("model_albu.txt")
knitr::opts_chunk$set(echo = TRUE)
library(HDInterval)
library(R2OpenBUGS)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000)
library(R2OpenBUGS)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=FALSE, save.history = FAlSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=FALSE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=0,b=0)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(c(0,0))
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a","b")
inits<-list(a=1,b=1)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data1,inits,params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data=data1,inits=inits,parameters.to.save=params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data=data1,inits=inits,parameters.to.save=params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data=data1,inits=inits,parameters.to.save=params,"model_albu.txt",n.chains=2, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(albumin[!is.na(mydata$V6)])
X<-albumin
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data=data1,inits=list(inits),parameters.to.save=params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
fit1$summary
alkaline<-as.numeric(mydata$V15)
hist(alkaline)
n<-length(mydata$V6[!is.na(mydata$V6)])
s<-sum(mydata$V6)
n
s
n<-length(alkaline[!is.na(alkaline)])
s<-sum(mydata$V6)
n
s
n<-length(alkaline[!is.na(alkaline)])
s<-sum(alkaline)
n
s
mean<-(s+0.001)/(n+0.001)
mode<-(s+0.001-1)/(n+0.001)
cil<-qgamma(0.05/2,618588.601,312.001)
ciu<-qgamma(1-0.05/2,618588.601,312.001)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
tst<-rgamma(1e5,618588.601,312.001)
hdi(tst)
n<-lengthbilirubin[!is.na(bilirubin)])
n<-length(bilirubin[!is.na(bilirubin)])
s<-sum(bilirubin)
n
s
mean<-n/s
mode<-(n-1)/(s)
cil<-qgamma(0.05/2,312,1015.9)
ciu<-qgamma(1-0.05/2,312,1015.9)
cat("Posterior mean: ",mean)
cat("Posterior mode: ",mode)
cat("Centered 95% Confidence Interval: [",cil,",",ciu,"]")
tst<-rgamma(1e5,312,1015.9)
hdi(tst)
n<-length(alkaline[!is.na(alkaline)])
X<-alkaline
data1<-list("X","n")
params<-c("a")
inits<-list(a=1)
fit1<-bugs(data=data1,inits=list(inits),parameters.to.save=params,"model_alka.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(alkaline[!is.na(alkaline)])
X<-alkaline
data1<-list("X","n")
params<-c("a")
inits<-list(a=1)
fit1<-bugs(data=data1,inits=list(inits),parameters.to.save=params,"model_alka.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
n<-length(alkaline[!is.na(alkaline)])
X<-alkaline
data1<-list("X","n")
params<-c("a")
inits<-list(a=1)
fit1<-bugs(data=data1,inits=list(inits),parameters.to.save=params,"model_alka.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
fit1$summary
triglicerides<-as.numeric(mydata$V17)
hist(triglicerides)
n<-length(triglicerides[!is.na(triglicerides)])
X<-triglicerides
data1<-list("X","n")
params<-c("a" , "b")
inits<-list(a=1,b=1)
fit1<-bugs(data=data1,inits=list(inits),parameters.to.save=params,"model_albu.txt",n.chains=1, n.iter=20000, n.burnin = 10000,debug=TRUE, save.history = FALSE, DIC=TRUE)
fit1$summary
triglicerides<-as.numeric(mydata$V17)
hist(triglicerides)
